<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>operator</title>
<link rel="stylesheet" href="styles.css"></head>
<body><p><a href='./index.html'>Main Page</a></p>
<h1 id='operator-documentation-for-the-catalis-cloudhmi-gateway-device'>Operator Documentation for the Catalis CloudHMI Gateway Device</h1>
<h2 id='overview'>Overview</h2>
<p>The Catalis CloudHMI gateway devices is a Raspberry Pi 4 (4 GB variant) running the Catalis CloudHMI service suite, the primary aims of which being:</p>
<ul>
<li>Polling a Catalis HMI </li>
<li>Storing polled data in a local database on an external USB &quot;key&quot;</li>
<li>Syncing the data in the USB key with a database in the Catalis cloud platform</li>

</ul>
<p>This documentation details the operation of the gateway device from an operator perspective. For documentation regarding the service suite running on the gateway device, refer to the technical documentation.</p>
<h2 id='components-and-basic-work-flow'>Components and Basic Work Flow</h2>
<p>The physical system is comprised of two main components. </p>
<h3 id='gateway-device'>Gateway Device</h3>
<p>A Raspberry Pi 4 (4 GB RAM) single-board ARM64 computer. Powered solely by 5 volt DC regulated input - has no internal battery. Communicates with the Catalis HMI via a physical link (an ethernet cable), and connects to the cloud via wireless network. </p>
<h3 id='usb-key'>USB Key</h3>
<p>The USB key is a crucial component of the system - the gateway device is activated when it is inserted, and deactivated when it is removed. The gateway device is also activated if the key is already inserted at boot up.</p>
<p>A key is defined by having a primary partition with a <code>vfat</code> (exFAT/FAT32) file system, and a file system label in the following format: <code>CAT-xxxxxxxx</code>, where each <code>x</code> represents a single digit to create a seven-digit unique identification corresponding to the Catalis machine&#39;s serial code.</p>
<p>The key will contain two main directories:</p>
<ol start='' >
<li><code>config/</code>: this directory contains modifiable configuration files for the operation of the gateway device, including parameters such as API endpoints and timing variables.</li>
<li><code>database/</code>: this is automatically generated by the gateway device when plugged in, and contains the local SQLite3 database. Do not attempt to write to the database, but feel free to use a database viewer to browse its contents.</li>

</ol>
<h4 id='recommendations'>Recommendations</h4>
<p>USB 2.0 is recommended for lower operating temperatures, and 32 GB is a safe storage capacity for extended operational periods.</p>
<h2 id='wireless-connectivity-recommendations'>Wireless Connectivity Recommendations</h2>
<p>A 2.4 GHz network is recommended for optimal connectivity range.</p>
<h2 id='physical-status-indicators'>Physical Status Indicators</h2>
<p>The housing of the gateway device features led clusters corresponding to various processes.</p>
<h3 id='service-status-indicators'>Service Status Indicators</h3>
<p>Each main service - Catalis CHMI (primary service), main initialization service, polling service, cloud sync service - has an led cluster assigned to it, with the following codes:</p>
<ul>
<li><strong>Red:</strong> indicates (fatal) service failure</li>
<li><strong>Green:</strong> indicates active service</li>
<li><strong>Off:</strong> indicates inactive (dead) service</li>

</ul>
<p>The polling and cloud sync service clusters include an additional yellow led which indicates non-fatal operational error:</p>
<ul>
<li><strong>Polling:</strong> LAN connection error, failed to poll</li>
<li><strong>Cloud Sync:</strong> failed to upload to cloud API</li>

</ul>
<p>Yellow lights may require operator interference, but do not require the service to be restarted. Red lights indicate serious issues that require a full service restart (removing and re-inserting) the USB key, at best. System administrator involvement may be indicated.</p>
<h3 id='network-status-indicators'>Network Status Indicators</h3>
<p>The network status LED cluster codes as follows:</p>
<ul>
<li><strong>Green:</strong> connected to network, has internet access</li>
<li><strong>Yellow:</strong> connected to network, no internet access</li>
<li><strong>Red:</strong> not connected to a network </li>

</ul>
<h2 id='configuration-files'>Configuration Files</h2>
<p>The <code>config/</code> directory in the USB key contains the following files.</p>
<h3 id='network-configuration---wirelessconf'>Network Configuration - <code>wireless.conf</code></h3>
<p>The gateway device is set up to connect to a WPA2-PSK nnetwork. This configuration file provides the information the gateway requires to connect to a named wireless network:</p>
<pre><code>network={
        ssid=&quot;ssid-name&quot;
        psk=&quot;wpa-key&quot;
}
</code></pre>
<h3 id='packet-configuration---packetconf'>Packet Configuration - <code>packet.conf</code></h3>
<p>This file defines the data polled for during operational phase. Consider the following example configuration:</p>
<pre><code>[report]
Frequency=30
Addresses=2000,2001,2002

[errlog]
Frequency=60
Addresses=2003,2004
</code></pre>
<p>This configuration defines two named packets - &quot;report&quot; and &quot;errlog&quot;. Each is assigned a polling frequency (ie. how often this packet is polled for) and a register address list. </p>
<h3 id='polling-configuration---pollingconf'>Polling Configuration - <code>polling.conf</code></h3>
<p>This configuration file controls sync timing and TCP connection parameters (for connecting to the HMI):</p>
<pre><code>CATALIS_HMI_HOST=&quot;192.168.1.3&quot;
CATALIS_POLLING_FREQUENCY=&quot;1&quot;
CATALIS_POLL_RETRY_INTERVAL=&quot;10&quot;
</code></pre>
<h3 id='cloud-sync-configuration---csyncconf'>Cloud Sync Configuration - <code>csync.conf</code></h3>
<p>This configuration file controls sync timing, and API access:</p>
<pre><code>CATALIS_SYNCING_FREQUENCY=&quot;120&quot;
CATALIS_SYNC_REQUEST_RETRY_INTERVAL=&quot;30&quot;
CATALIS_SYNC_MAX_PAYLOAD=&quot;250&quot;
CATALIS_CSYNC_API_ENDPOINT=&quot;https://endpoint-url/api/sync&quot;
</code></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>